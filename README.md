# NixForge

**NixForge** is a modular and reproducible server system built with [NixOS](https://nixos.org/). It allows you to run a fully self-hosted infrastructure, including:

- Routing (not implemented, but it's intended to work as a router), firewall, DHCP, and DNS
- Media streaming, torrent downloads, dynamic DNS, and live dashboards
- Cockpit for remote system administration with virtual machine management
- All services containerized with clean separation

Everything is declaratively managed and version-controlled using Git.

---

## 📁 Project Structure

```
/etc/nixos
├── configuration.nix                 # Main entrypoint
├── hardware-configuration.nix        # Auto-generated by NixOS
└── nixforge/
    ├── containers/                   # Individual system containers
    │   ├── cockpit/
    │   │   ├── configuration.nix
    │   │   ├── users.cred
    │   │   ├── users.cred.example
    │   │   └── packages/
    │   ├── dashboard/
    │   │   ├── configuration.nix
    │   │   └── site/
    │   ├── ddns-ionos/
    │   ├── media/
    │   └── torrent/
    └── modules/                      # NixOS configuration modules
```

---

## ✅ Features

- **Networking:** Static IPs, NAT, and dual-LAN support
- **Firewall:** Manual iptables rules and port forwarding
- **DNS & DHCP:** Provided via `dnsmasq`
- **Containers:** Isolated environments for each service
- **Media:** Jellyfin streaming server (`media`)
- **Torrents:** Secure Transmission container (`torrent`)
- **DDNS:** Dynamic DNS updates for IONOS domains (**needed for the subdomains for each service if you don't have static IP**)
- **Dashboard:** Real-time resource metrics with Chart.js
- **Cockpit:** Web-based system admin + VM manager

---

## 🚀 Getting Started

1. **Clone this repository** to your NixOS system:

```bash
git clone https://github.com/CarlosClementBellido/NixForge.git /etc/nixos
cd /etc/nixos
```

2. **Edit `configuration.nix`** to include desired modules and containers.

  * Basic `configuration.nix`:
    ```nix
    { config, lib, pkgs, ... }:

    {
      imports =
        [
          ./hardware-configuration.nix
    
          ./nixforge/modules/system-packages.nix
          ./nixforge/modules/users.nix
          ./nixforge/modules/openssh.nix
          ./nixforge/modules/networking.nix
          ./nixforge/modules/firewall.nix
          ./nixforge/modules/dnsmasq.nix
          ./nixforge/modules/samba.nix
          ./nixforge/modules/nginx.nix
          ./nixforge/modules/containers.nix
          ./nixforge/modules/nix-ld.nix
          ./nixforge/modules/metrics-host.nix
        ];
    
      boot.loader.systemd-boot.enable = true;
      boot.loader.efi.canTouchEfiVariables = false;
    
      system.stateVersion = "24.05";
    }
    ```

4. **Apply the configuration:**

```bash
sudo nixos-rebuild switch
```

---

## 🔐 Secrets

Copy example credentials:

```bash
cp users.cred.example users.cred
cp transmission.cred.example transmission.cred
```

---

## 🛰️ Access Points

| Service      | URL / Port                 | Description                         |
|--------------|----------------------------|-------------------------------------|
| Dashboard    | `http://your.domain`    | System metrics dashboard            |
| Cockpit      | `https://cockpit.your.domain`      | Admin interface via Nginx + TLS     |
| Jellyfin     | `http://jellyfin.your.domain`      | Media streaming                     |
| Transmission | `http://transmission.your.domain`      | Torrent downloads                   |

---

## 📅 TODO

- Full router setup

---

## 📜 License

MIT © Carlos Clement Bellido
